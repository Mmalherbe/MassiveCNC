(%unit (%imports (%import "System") (%import "System.Runtime.InteropServices")) (%package "UpgradeSolution1Support.PInvoke.SafeNative" (%class "user32" (%public) (%static) (%method "AppendMenu" (%int) (%args (%variable (%byval) (%var "hMenu") (%int)) (%variable (%byval) (%var "wFlags") (%int)) (%variable (%byval) (%var "wIDNewItem") (%int)) (%variable (%byref) (%var "lpNewItem") (%string))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.AppendMenu") (%param (%id "hMenu") (%id "wFlags") (%id "wIDNewItem") (%ref-param (%id "lpNewItem")))))) (%public) (%shared)) (%method "CreatePopupMenu" (%int) (%args) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.CreatePopupMenu") (%param)))) (%public) (%shared)) (%method "DeleteMenu" (%int) (%args (%variable (%byval) (%var "hMenu") (%int)) (%variable (%byval) (%var "nPosition") (%int)) (%variable (%byval) (%var "uFlags") (%int))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.DeleteMenu") (%param (%id "hMenu") (%id "nPosition") (%id "uFlags"))))) (%public) (%shared)) (%method "DestroyMenu" (%int) (%args (%variable (%byval) (%var "hMenu") (%int))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.DestroyMenu") (%param (%id "hMenu"))))) (%public) (%shared)) (%method "EnableMenuItem" (%int) (%args (%variable (%byval) (%var "hMenu") (%int)) (%variable (%byval) (%var "wIDEnableItem") (%int)) (%variable (%byval) (%var "wEnable") (%int))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.EnableMenuItem") (%param (%id "hMenu") (%id "wIDEnableItem") (%id "wEnable"))))) (%public) (%shared)) (%method "GetCursorPos" (%int) (%args (%variable (%byref) (%var "lpPoint") (%user-type "UpgradeSolution1Support.PInvoke.UnsafeNative.Structures.POINT"))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.GetCursorPos") (%param (%ref-param (%id "lpPoint")))))) (%public) (%shared)) (%method "GetDesktopWindow" (%int) (%args) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.GetDesktopWindow") (%param)))) (%public) (%shared)) (%method "GetKeyState" (%short) (%args (%variable (%byval) (%var "nVirtKey") (%int))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.GetKeyState") (%param (%id "nVirtKey"))))) (%public) (%shared)) (%method "GetWindow" (%int) (%args (%variable (%byval) (%var "Hwnd") (%int)) (%variable (%byval) (%var "wCmd") (%int))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.GetWindow") (%param (%id "Hwnd") (%id "wCmd"))))) (%public) (%shared)) (%method "GetWindowRect" (%int) (%args (%variable (%byval) (%var "Hwnd") (%int)) (%variable (%byref) (%var "lpRect") (%user-type "UpgradeSolution1Support.PInvoke.UnsafeNative.Structures.RECT"))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.GetWindowRect") (%param (%id "Hwnd") (%ref-param (%id "lpRect")))))) (%public) (%shared)) (%method "GetWindowThreadProcessId" (%int) (%args (%variable (%byval) (%var "Hwnd") (%int)) (%variable (%byref) (%var "lpdwProcessId") (%int))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.GetWindowThreadProcessId") (%param (%id "Hwnd") (%ref-param (%id "lpdwProcessId")))))) (%public) (%shared)) (%method "SetMenuDefaultItem" (%int) (%args (%variable (%byval) (%var "hMenu") (%int)) (%variable (%byval) (%var "uItem") (%int)) (%variable (%byval) (%var "fByPos") (%int))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.SetMenuDefaultItem") (%param (%id "hMenu") (%id "uItem") (%id "fByPos"))))) (%public) (%shared)) (%method "SetMenuItemBitmaps" (%int) (%args (%variable (%byval) (%var "hMenu") (%int)) (%variable (%byval) (%var "nPosition") (%int)) (%variable (%byval) (%var "wFlags") (%int)) (%variable (%byval) (%var "hBitmapUnchecked") (%int)) (%variable (%byval) (%var "hBitmapChecked") (%int))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.SetMenuItemBitmaps") (%param (%id "hMenu") (%id "nPosition") (%id "wFlags") (%id "hBitmapUnchecked") (%id "hBitmapChecked"))))) (%public) (%shared)) (%method "SetWindowPos" (%int) (%args (%variable (%byval) (%var "Hwnd") (%int)) (%variable (%byval) (%var "hWndInsertAfter") (%int)) (%variable (%byval) (%var "x") (%int)) (%variable (%byval) (%var "y") (%int)) (%variable (%byval) (%var "cX") (%int)) (%variable (%byval) (%var "cY") (%int)) (%variable (%byval) (%var "wFlags") (%int))) (%seq (%return (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.SetWindowPos") (%param (%id "Hwnd") (%id "hWndInsertAfter") (%id "x") (%id "y") (%id "cX") (%id "cY") (%id "wFlags"))))) (%public) (%shared)) (%method "TrackPopupMenuEx" (%int) (%args (%variable (%byval) (%var "hMenu") (%int)) (%variable (%byval) (%var "wFlags") (%int)) (%variable (%byval) (%var "x") (%int)) (%variable (%byval) (%var "y") (%int)) (%variable (%byval) (%var "Hwnd") (%int)) (%variable (%byval) (%var "lptpm") (%int))) (%seq (%variable-list (%variable (%var "result" (%init-value 0)) (%int))) (%variable (%var "handle" (%init-value (%call (%id "GCHandle.Alloc") (%param (%id "lptpm") (%id "GCHandleType.Pinned"))))) (%user-type "GCHandle")) (%try (%seq (%variable (%var "tmpPtr" (%init-value (%call (%dot (%id "handle") (%id "AddrOfPinnedObject")) (%param)))) (%user-type "IntPtr")) (%= (%id "result") (%call (%id "UpgradeSolution1Support.PInvoke.UnsafeNative.user32.TrackPopupMenuEx") (%param (%id "hMenu") (%id "wFlags") (%id "x") (%id "y") (%id "Hwnd") (%id "tmpPtr")))) (%= (%id "lptpm") (%call (%id "Marshal.ReadInt16") (%param (%id "tmpPtr"))))) (%finally (%seq (%call (%dot (%id "handle") (%id "Free")) (%param))))) (%return (%id "result"))) (%public) (%shared)))))